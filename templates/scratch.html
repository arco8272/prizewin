{% extends "base.html" %}

{% block title %}Scratch Card - Win Amazing Prizes!{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="scratch-card">
        <div class="scratch-card-cover-container">
            <canvas class="scratch-card-canvas" width="320" height="320"></canvas>
            <!-- Only needed for Safari and iOS browsers -->
            <img class="scratch-card-canvas-render hidden" alt="">
            <div class="scratch-card-cover shine">
                <svg class="scratch-card-cover-background" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 320">
                    <defs>
                        <pattern id="dots" patternUnits="userSpaceOnUse" width="20" height="20">
                            <circle cx="10" cy="10" r="2" fill="currentColor" opacity="0.3"/>
                        </pattern>
                    </defs>
                    <rect width="100%" height="100%" fill="url(#dots)"/>
                    <text x="160" y="160" text-anchor="middle" dominant-baseline="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="currentColor">
                        SCRATCH HERE
                    </text>
                </svg>
            </div>
        </div>
        <div id="prize-content" class="prize-content">
            <div class="text-center p-4">
                <i class="fas fa-gift fa-4x text-primary mb-3"></i>
                <h3>üéÅ Amazing Prize!</h3>
                <p class="lead">You've won something special!</p>
            </div>
        </div>
    </div>

    <p class="scratch-card-text">üéÅ Scratch for a surprise!</p>
    
    <div class="text-center mt-4">
        <form id="scratch-form" method="POST" action="{{ url_for('scratch_result') }}" style="display: none;">
            <button type="submit" id="redeem-btn" class="btn btn-success btn-lg px-5">
                <i class="fas fa-gift me-2"></i>Claim Your Prize
            </button>
        </form>
    </div>
</div>

<!-- SVG Filters -->
<svg width="0" height="0">
    <filter id="remove-black" color-interpolation-filters="sRGB">
        <feColorMatrix
            type="matrix"
            values="1 0 0 0 0
                    0 1 0 0 0
                    0 0 1 0 0
                    -1 -1 -1 0 1"
            result="black-pixels"
        />
        <feComposite in="SourceGraphic" in2="black-pixels" operator="out" />
    </filter>
    <filter id="noise">
        <feTurbulence baseFrequency="0.5"></feTurbulence>
    </filter>
</svg>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
<script>
// Override the redeem button behavior for token-based scratching
document.addEventListener('DOMContentLoaded', function() {
    // Update the existing script to show the form instead of redirecting
    window.revealPrize = function() {
        document.getElementById('scratch-form').style.display = 'block';
    };
});
</script>
{% endblock %}